@if (post()) {
<main class="post-detail">
  <div class="post-container">
    <section class="post-hero">
      <h1 class="post-title">{{ post()!.title }}</h1>
      <div class="post-image">
        <img [src]="post()!.bannerUrl" [alt]="post()!.title" />
      </div>
    </section>

    <div class="post-content-wrapper">
      <div class="post-main">
        <header class="post-header">
          <div class="author-info">
            <div class="author-avatar">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 512 512"
                width="24"
                height="24"
              >
                <circle cx="256" cy="256" r="200" fill="#FFFFFF" />
                <circle cx="256" cy="200" r="80" fill="#808080" />
                <path d="M128 400c0-70 56-128 128-128s128 58 128 128" fill="#808080" />
              </svg>
            </div>
            <div class="author-details">
              <span class="author-name"
                >{{ post()!.author.firstName }} {{ post()!.author.lastName }}</span
              >
              <span class="post-date"
                >Posted at {{ post()!.postedAt | date:'short' }}</span
              >
            </div>
          </div>

          <div class="post-actions">
            <button
              class="like-button"
              [class.liked]="post()!.isLiked"
              [disabled]="isLiking()"
              (click)="toggleLike()"
            >
              <svg
                class="like-icon"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                width="20"
                height="20"
              >
                @if (post()!.isLiked) {
                <!-- Corazón lleno -->
                <path
                  d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                  fill="currentColor"
                />
                } @else {
                <!-- Corazón vacío -->
                <path
                  d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"
                  fill="currentColor"
                />
                }
              </svg>
              <span class="like-count">{{ post()!.likesCount || 0 }}</span>
            </button>
          </div>
        </header>

        <!-- Post Content -->
        <div class="post-body">
          <!-- TODO: Add categories when available in Post interface -->
          <div class="post-categories">
            <span class="category-tag">By {{ post()!.author.username }}</span>
          </div>

          <div class="post-text">
            @for (paragraph of post()!.body.split('\n\n'); track $index) {
            <p>{{ paragraph }}</p>
            }
          </div>
        </div>

        <!-- Comments Section -->
        <section class="comments-section">
          <h3 class="comments-title">Comentarios</h3>

          <!-- Comment Form -->
          <form
            class="comment-form"
            [formGroup]="commentForm"
            (ngSubmit)="onSubmitComment()"
          >
            <div class="comment-input-wrapper">
              <div class="comment-avatar">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 512 512"
                  width="32"
                  height="32"
                >
                  <circle cx="256" cy="256" r="200" fill="#FFFFFF" />
                  <circle cx="256" cy="200" r="80" fill="#808080" />
                  <path d="M128 400c0-70 56-128 128-128s128 58 128 128" fill="#808080" />
                </svg>
              </div>
              <div class="comment-input-content">
                <textarea
                  class="comment-textarea"
                  [class.error]="hasCommentError()"
                  formControlName="comment"
                  placeholder="Escribe tu comentario..."
                  rows="4"
                ></textarea>
                @if (hasCommentError()) {
                <span class="error-message">{{ getCommentError() }}</span>
                }
                <div class="comment-actions">
                  <button
                    type="submit"
                    class="btn-submit"
                    [disabled]="commentForm.invalid"
                  >
                    Publicar comentario
                  </button>
                </div>
              </div>
            </div>
          </form>

          <div class="punlished-comments">
            @for (comment of comments(); track comment.id) {
            <div class="comment">
              <div class="comment-avatar">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 512 512"
                  width="32"
                  height="32"
                >
                  <circle cx="256" cy="256" r="200" fill="#FFFFFF" />
                  <circle cx="256" cy="200" r="80" fill="#808080" />
                  <path d="M128 400c0-70 56-128 128-128s128 58 128 128" fill="#808080" />
                </svg>
              </div>
              <div class="comment-content">
                <div class="comment-header">
                  <span class="comment-author">{{ comment.author }}</span>
                  @if (comment.isTeamMember) {
                  <span class="team-badge">DevTalles Team</span>
                  }
                </div>
                <p class="comment-text">{{ comment.content }}</p>
                <span class="comment-time">{{ comment.publishedAt }}</span>
              </div>
            </div>
            }
          </div>
        </section>
      </div>

      <!-- Sidebar -->
      <aside class="post-sidebar">
        <div class="sidebar-widget">
          <div class="widget-header">
            <div class="author-avatar">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 512 512"
                width="40"
                height="40"
              >
                <circle cx="256" cy="256" r="200" fill="#FFFFFF" />
                <circle cx="256" cy="200" r="80" fill="#808080" />
                <path d="M128 400c0-70 56-128 128-128s128 58 128 128" fill="#808080" />
              </svg>
            </div>
            <div>
              <h4>Author</h4>
              <p class="author-bio">
                Hello world! I love programming, playing videogames and drinking coffee!
              </p>
            </div>
          </div>
        </div>

        <div class="sidebar-widget">
          <h4>Más de Author</h4>
          <div class="related-posts">
            @for (i of [1,2,3,4,5,6,7,8]; track i) {
            <div class="related-post">
              <h5>Hello world!</h5>
              <div class="related-categories">
                <span class="category-tag small">Categoría</span>
                <span class="category-tag small">Categoría</span>
              </div>
            </div>
            }
          </div>
        </div>
      </aside>
    </div>
  </div>
</main>
}
